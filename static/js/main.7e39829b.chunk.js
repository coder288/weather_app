(this.webpackJsonpweather=this.webpackJsonpweather||[]).push([[0],{17:function(e,t,a){e.exports=a(33)},28:function(e,t,a){},29:function(e,t,a){},30:function(e,t,a){},31:function(e,t,a){},33:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),r=a(9),o=a(4),s=a(6),l=a(16),i=(a(28),a(29),function(e){return{type:"LOADING",payload:e}}),d=function(e){return{type:"FETCH_WEATHER",args:e}},m=function(e){return{type:"SAVE_WEATHER_TO_STATE",payload:e}},u=function(e){return{type:"SAVE_CITY_NAME_IN_STATE",payload:e}},_=function(e){return{type:"TRIGGER_SOURCES",payload:e}},h=function(){var e=Object(o.c)(),t=Object(o.d)((function(e){return e.openSources})),a=Object(o.d)((function(e){return e.source})),r=Object(o.d)((function(e){return e.coords})),s=function(a){a.target.closest(".header__source-ico")&&e(_(!t)),!a.target.closest(".header__source")&&t&&e(_(!1)),a.target.closest(".header__source-item")&&(e(i(!0)),e(_(!1)),e(function(e){return{type:"CHANGE_SOURCE",payload:e}}(parseInt(a.target.dataset.id))),e(d({source:parseInt(a.target.dataset.id),coords:r})))};return Object(n.useEffect)((function(){return document.addEventListener("click",s),function(){document.removeEventListener("click",s)}}),[t,a]),c.a.createElement("div",{className:"header__wrapper"},c.a.createElement("div",{className:"header"},c.a.createElement("div",{className:"header__source"},c.a.createElement("i",{className:"header__source-ico"}),c.a.createElement("div",{className:t?"header__source-items header__source-items--select":"header__source-items"},c.a.createElement("div",{className:"header__source-item","data-id":"1"},"\u042f\u043d\u0434\u0435\u043a\u0441"),c.a.createElement("div",{className:"header__source-item","data-id":"2"},"OpenWeatherMap"))),c.a.createElement("div",{className:"header__title"},"Weather")))},E=(a(30),function(){return c.a.createElement("div",{className:"loader"},c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null))}),v=(a(31),function(){var e=Object(o.d)((function(e){return e.weather})),t=Object(o.d)((function(e){return e.city})),a=["\u044f\u043d\u0432\u0430\u0440\u044f","\u0444\u0435\u0432\u0440\u0430\u043b\u044f","\u043c\u0430\u0440\u0442\u0430","\u0430\u043f\u0440\u0435\u043b\u044f","\u043c\u0430\u044f","\u0438\u044e\u043d\u044f","\u0438\u044e\u043b\u044f","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u043e\u043a\u0442\u044f\u0431\u0440\u044f","\u043d\u043e\u044f\u0431\u0440\u044f","\u0434\u0435\u043a\u0430\u0431\u0440\u044f"],n={clear:"\u044f\u0441\u043d\u043e","partly-cloudy":"\u043c\u0430\u043b\u043e\u043e\u0431\u043b\u0430\u0447\u043d\u043e",cloudy:"\u043e\u0431\u043b\u0430\u0447\u043d\u043e \u0441 \u043f\u0440\u043e\u044f\u0441\u043d\u0435\u043d\u0438\u044f\u043c\u0438",overcast:"\u043f\u0430\u0441\u043c\u0443\u0440\u043d\u043e","partly-cloudy-and-light-rain":"\u043d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0434\u043e\u0436\u0434\u044c","partly-cloudy-and-rain":"\u0434\u043e\u0436\u0434\u044c","overcast-and-rain":"\u0441\u0438\u043b\u044c\u043d\u044b\u0439 \u0434\u043e\u0436\u0434\u044c","overcast-thunderstorms-with-rain":"\u0441\u0438\u043b\u044c\u043d\u044b\u0439 \u0434\u043e\u0436\u0434\u044c, \u0433\u0440\u043e\u0437\u0430","cloudy-and-light-rain":"\u043d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0434\u043e\u0436\u0434\u044c","overcast-and-light-rain":"\u043d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0434\u043e\u0436\u0434\u044c","cloudy-and-rain":"\u0434\u043e\u0436\u0434\u044c","overcast-and-wet-snow":"\u0434\u043e\u0436\u0434\u044c \u0441\u043e \u0441\u043d\u0435\u0433\u043e\u043c","partly-cloudy-and-light-snow":"\u043d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0441\u043d\u0435\u0433","partly-cloudy-and-snow":"\u0441\u043d\u0435\u0433","overcast-and-snow":"\u0441\u043d\u0435\u0433\u043e\u043f\u0430\u0434","cloudy-and-light-snow":"\u043d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0441\u043d\u0435\u0433","overcast-and-light-snow":"\u043d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0441\u043d\u0435\u0433","cloudy-and-snow":"\u0441\u043d\u0435\u0433"};return e.days?c.a.createElement("div",{className:"weather"},c.a.createElement("div",{className:"weather__title"},"\u041f\u043e\u0433\u043e\u0434\u0430 ",t?"".concat(t):""),c.a.createElement("div",{className:"weather__days"},c.a.createElement("div",{className:"wth__descr-wrap"},c.a.createElement("div",{className:"wth__descr-items"},c.a.createElement("div",{className:"wth__descr wth__descr--day"},"\u0414\u0435\u043d\u044c"),c.a.createElement("div",{className:"wth__descr wth__descr--night"},"\u041d\u043e\u0447\u044c"))),e.days&&e.days.map((function(e){return c.a.createElement("div",{className:"wth__day",key:e.date},c.a.createElement("div",{className:"wth__col wth__col--date"},c.a.createElement("div",{className:"wth__date"},new Date(e.date).getDate()),c.a.createElement("div",{className:"wth__meta-date"},c.a.createElement("div",{className:"wth__month"},a[new Date(e.date).getMonth()]),c.a.createElement("div",{className:"wth__week"},new Date(e.date).getFullYear()))),c.a.createElement("div",{className:"wth__col wth__col--icon"},c.a.createElement("i",{className:"wth__icon wth__icon--".concat(e.day.condition)})),c.a.createElement("div",{className:"wth__col wth__col--morning"},c.a.createElement("div",{className:"wth__time"},"\u0423\u0442\u0440\u043e"),c.a.createElement("div",{className:"wth__temp wth__temp--".concat(e.morning.condition)},e.morning.temp),c.a.createElement("div",{className:"wth__text-descr"},n[e.morning.condition])),c.a.createElement("div",{className:"wth__col wth__col--day"},c.a.createElement("div",{className:"wth__time"},"\u0414\u0435\u043d\u044c"),c.a.createElement("div",{className:"wth__temp wth__temp--".concat(e.day.condition)},e.day.temp),c.a.createElement("div",{className:"wth__text-descr"},n[e.day.condition])),c.a.createElement("div",{className:"wth__col wth__col--evening"},c.a.createElement("div",{className:"wth__time"},"\u0412\u0435\u0447\u0435\u0440"),c.a.createElement("div",{className:"wth__temp wth__temp--".concat(e.evening.condition)},e.evening.temp),c.a.createElement("div",{className:"wth__text-descr"},n[e.evening.condition])),c.a.createElement("div",{className:"wth__col wth__col--night"},c.a.createElement("div",{className:"wth__time"},"\u041d\u043e\u0447\u044c"),c.a.createElement("div",{className:"wth__temp wth__temp--".concat(e.night.condition)},e.night.temp),c.a.createElement("div",{className:"wth__text-descr"},n[e.night.condition])))})))):c.a.createElement("div",{className:"weather__alert"},"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430!",c.a.createElement("br",null),c.a.createElement("br",null),"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443.")});var w=Object(o.b)()((function(e){var t=e.dispatch,a=Object(o.d)((function(e){return e.loading}));console.log(a);var n=Object(o.d)((function(e){return e.source}));return navigator.geolocation.getCurrentPosition((function(e){var a={lat:e.coords.latitude,lng:e.coords.longitude},c=localStorage.getItem("position");if(!c)return localStorage.setItem("position",JSON.stringify(a)),console.log("\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e"),void t(d({source:n,coords:a}));if((c=JSON.parse(c)).lat===a.lat&&c.lng===a.lng){console.log("\u0422\u043e \u0436\u0435 \u043c\u0435\u0441\u0442\u043e");var r=parseInt(localStorage.getItem("lastWeatherQuery"));Date.now()-r>72e5?(t(d({source:n,coords:a})),console.log("\u041d\u0443\u0436\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c\u0441\u044f")):(console.log("\u041f\u0440\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a \u043c\u043d\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438"),t(i(!1)),localStorage.getItem("cityName")&&t(u(localStorage.getItem("cityName"))))}else t(d({source:n,coords:a}));localStorage.getItem("weather")?t(m(JSON.parse(localStorage.getItem("weather")))):t(d({source:n,coords:a}))})),a?c.a.createElement(E,null):c.a.createElement("div",{className:"weather__wrapper"},c.a.createElement(h,null),c.a.createElement(v,null))})),g={loading:!0,weather:{},coords:{lat:55.18367385864258,lng:30.20479011535645},city:"",openSources:!1,source:1},p=a(8),y=a.n(p),N=a(5),f=y.a.mark(j),b=y.a.mark(I),O=function(e){var t=e.args,a=new FormData;return a.append("coords",JSON.stringify(t.coords)),fetch("http://beta.mikron.by/w".concat(t.source,"/"),{method:"post",body:a}).then((function(e){return e.json()}))},S=function(e){var t=e.args;return fetch("https://geocode-maps.yandex.ru/1.x/?apikey=783836a5-c84b-49f6-a36c-018dfb67e707&geocode=".concat(t.coords.lng,",").concat(t.coords.lat,"&format=json")).then((function(e){return e.json()}))};function j(e){var t,a,n;return y.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,Object(N.a)((function(){return O(e)}));case 3:return t=c.sent,c.next=6,Object(N.b)(m(t));case 6:if(!t.success){c.next=16;break}return c.next=9,Object(N.a)((function(){return S(e)}));case 9:return a=c.sent,n=a.response.GeoObjectCollection.featureMember[2].GeoObject.name,c.next=13,Object(N.b)(u(n));case 13:localStorage.setItem("cityName",n),localStorage.setItem("weather",JSON.stringify(t)),localStorage.setItem("lastWeatherQuery",t.now.toString());case 16:return c.next=18,Object(N.b)(i(!1));case 18:c.next=25;break;case 20:return c.prev=20,c.t0=c.catch(0),console.log(c.t0),c.next=25,Object(N.b)(i(!1));case 25:case"end":return c.stop()}}),f,null,[[0,20]])}function I(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(N.c)("FETCH_WEATHER",j);case 2:case"end":return e.stop()}}),b)}var T=Object(l.a)(),x=Object(s.d)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOADING":return Object.assign({},e,{loading:t.payload});case"SAVE_WEATHER_TO_STATE":return Object.assign({},e,{weather:t.payload});case"SAVE_CITY_NAME_IN_STATE":return Object.assign({},e,{city:t.payload});case"TRIGGER_SOURCES":return Object.assign({},e,{openSources:t.payload});case"CHANGE_SOURCE":return Object.assign({},e,{source:t.payload});default:return e}}),Object(s.a)(T));T.run(I),Object(r.render)(c.a.createElement(o.a,{store:x},c.a.createElement(w,null)),document.querySelector(".layout"))}},[[17,1,2]]]);
//# sourceMappingURL=main.7e39829b.chunk.js.map